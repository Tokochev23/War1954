// ============================================================
// ARQUIVO: public/index.html
// ------------------------------------------------------------
// Este √© o arquivo HTML principal. A aplica√ß√£o React ser√°
// injetada no elemento com o ID 'root'.
// ============================================================
/*
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RPG 1954 - Portal Oficial</title>
</head>
<body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
</body>
</html>
*/

// ============================================================
// ARQUIVO: src/index.js
// ------------------------------------------------------------
// Este arquivo renderiza o componente principal 'App' no DOM.
// ============================================================
/*
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App.jsx';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
*/

// ============================================================
// ARQUIVO: src/index.css
// ------------------------------------------------------------
// Arquivo CSS global, usado principalmente pelo Tailwind.
// ============================================================
/*
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  font-family: 'Inter', sans-serif;
  @apply bg-slate-950 text-slate-100;
}
*/

// ============================================================
// ARQUIVO: src/App.jsx
// ------------------------------------------------------------
// Componente principal da aplica√ß√£o.
// ============================================================
import React, { useState } from "react";
import { motion } from "framer-motion";
import {
  Globe2,
  Users,
  History,
  TrendingUp,
  Shield,
  Flag,
  LogIn,
  ChevronRight,
  Dice5,
  Settings,
  Map,
  X,
  RotateCcw,
  Plus,
  Search,
} from "lucide-react";
// Importa√ß√µes do Firebase - descomente e configure para usar
// import { initializeApp } from 'firebase/app';
// import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signInAnonymously } from 'firebase/auth';
// import { getFirestore, collection, onSnapshot, query } from 'firebase/firestore';

const sampleEra = "1954";
const sampleTurn = 12;

const samplePublicCountries = [
  { id: "USA", name: "Estados Unidos", pib: 523.2, estabilidade: 84, flag: "üá∫üá∏" },
  { id: "BRA", name: "Brasil", pib: 76.1, estabilidade: 72, flag: "üáßüá∑" },
  { id: "FRA", name: "Fran√ßa", pib: 143.7, estabilidade: 81, flag: "üá´üá∑" },
  { id: "JPN", name: "Jap√£o", pib: 98.3, estabilidade: 77, flag: "üáØüáµ" },
];

const sampleTurnPosts = [
  {
    turn: 12,
    title: "Turno 12 ‚Äî Relat√≥rio P√∫blico",
    url: "#",
    summary:
      "Resumo das a√ß√µes e resultados narrados no grupo do Facebook. Clique para abrir o post oficial.",
  },
  {
    turn: 11,
    title: "Turno 11 ‚Äî Relat√≥rio P√∫blico",
    url: "#",
    summary: "Resultados do turno 11 (link para o Facebook).",
  },
];

const fmt = (n) => new Intl.NumberFormat("pt-BR", { style: 'decimal', minimumFractionDigits: 1, maximumFractionDigits: 1 }).format(n);

export default function App() {
  const [logged, setLogged] = useState(false);
  const [isAdmin, setIsAdmin] = useState(false);
  const [userCountry] = useState({ id: "BRA", name: "Brasil" });
  const [loginModalOpen, setLoginModalOpen] = useState(false);
  const [publicCountries, setPublicCountries] = useState(samplePublicCountries);
  const [turnPosts, setTurnPosts] = useState(sampleTurnPosts);

  const handleLogin = (email, password) => {
    // L√≥gica de login com Firebase Auth viria aqui
    // signInWithEmailAndPassword(auth, email, password)
    //   .then((userCredential) => {
    //     setLogged(true);
    //     // L√≥gica para definir se √© admin ou n√£o
    //   })
    //   .catch((error) => {
    //     console.error("Login failed", error);
    //   });
    console.log(`Tentativa de login com email: ${email} e senha: ${password}`);
    if (email === "narrador@rpg.com") {
      setIsAdmin(true);
    }
    setLogged(true);
    setLoginModalOpen(false);
  };

  const handleLogout = () => {
    setLogged(false);
    setIsAdmin(false);
    // L√≥gica de logout do Firebase Auth viria aqui
    // auth.signOut();
  };

  return (
    <div className="min-h-screen w-full bg-gradient-to-b from-slate-950 via-slate-900 to-slate-900 text-slate-100">
      {loginModalOpen && (
        <LoginModal
          onClose={() => setLoginModalOpen(false)}
          onLogin={handleLogin}
        />
      )}
      
      <Navbar logged={logged} isAdmin={isAdmin} onLogin={() => setLoginModalOpen(true)} onLogout={handleLogout} />
      
      <Hero />
      
      <main className="mx-auto max-w-7xl px-4 py-6">
        <PlayerAndNarratorPanel logged={logged} isAdmin={isAdmin} userCountry={userCountry} />
        <PublicCountriesPanel countries={publicCountries} />
        <TurnFeedPanel posts={turnPosts} />
      </main>

      <Footer />
    </div>
  );
}

// ============================================================
// M√ìDULOS (Componentes)
// ============================================================
// Estes componentes podem ser movidos para uma pasta `src/components/`
// para uma organiza√ß√£o ainda melhor.
// ============================================================

function LoginModal({ onClose, onLogin }) {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");

  const handleSubmit = (e) => {
    e.preventDefault();
    onLogin(email, password);
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm">
      <motion.div
        initial={{ scale: 0.9, opacity: 0 }}
        animate={{ scale: 1, opacity: 1 }}
        exit={{ scale: 0.9, opacity: 0 }}
        className="bg-slate-800 rounded-3xl p-8 shadow-2xl max-w-sm w-full mx-4 border border-white/10"
      >
        <div className="flex items-center justify-between mb-4">
          <h3 className="text-xl font-bold text-white">Entrar</h3>
          <button onClick={onClose} className="p-2 -mr-2 rounded-full hover:bg-white/10 transition">
            <X className="h-6 w-6 text-slate-400 hover:text-white" />
          </button>
        </div>
        <form onSubmit={handleSubmit}>
          <input
            type="email"
            placeholder="E-mail"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full p-3 rounded-xl bg-slate-700 text-white mb-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <input
            type="password"
            placeholder="Senha"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full p-3 rounded-xl bg-slate-700 text-white mb-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <button
            type="submit"
            className="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 rounded-xl transition duration-300 transform hover:scale-[1.01]"
          >
            Entrar
          </button>
        </form>
      </motion.div>
    </div>
  );
}

function Navbar({ logged, isAdmin, onLogin, onLogout }) {
  return (
    <nav className="sticky top-0 z-30 backdrop-blur supports-[backdrop-filter]:bg-slate-900/50 bg-slate-900/60 border-b border-white/10">
      <div className="mx-auto max-w-7xl px-4 py-3 flex items-center justify-between">
        <div className="flex items-center gap-3">
          <div className="h-9 w-9 rounded-xl bg-gradient-to-br from-amber-400 to-rose-500 grid place-items-center shadow-lg shadow-rose-500/20">
            <Dice5 className="h-5 w-5 text-slate-900" />
          </div>
          <div className="leading-tight">
            <p className="text-lg font-semibold tracking-tight">WAR ‚Ä¢ Era {sampleEra}</p>
            <p className="text-xs text-slate-300">RPG de Pa√≠ses ‚Äî Portal Oficial</p>
          </div>
        </div>

        <div className="hidden md:flex items-center gap-6 text-sm">
          <a className="hover:text-white/90 text-slate-300" href="#paises">Pa√≠ses</a>
          <a className="hover:text-white/90 text-slate-300" href="#turnos">Turnos</a>
          {isAdmin && <a className="hover:text-white/90 text-slate-300" href="#narrador">Narrador</a>}
        </div>

        <div className="flex items-center gap-2">
          {logged ? (
            <button
              onClick={onLogout}
              className="inline-flex items-center gap-2 rounded-xl bg-emerald-500/90 hover:bg-emerald-500 px-3 py-2 text-sm font-semibold shadow ring-1 ring-white/10"
            >
              <Flag className="h-4 w-4" /> Meu pa√≠s
            </button>
          ) : (
            <button
              onClick={onLogin}
              className="inline-flex items-center gap-2 rounded-xl bg-white/10 hover:bg-white/15 px-3 py-2 text-sm font-semibold shadow ring-1 ring-white/10"
            >
              <LogIn className="h-4 w-4" /> Entrar
            </button>
          )}
        </div>
      </div>
    </nav>
  );
}

function Hero() {
  const [logged, setLogged] = useState(false);
  const [loginModalOpen, setLoginModalOpen] = useState(false);
  const onLogin = () => setLoginModalOpen(true);
  const onClose = () => setLoginModalOpen(false);

  return (
    <header className="relative mx-auto max-w-7xl px-4 pt-10 pb-8">
      {loginModalOpen && <LoginModal onClose={onClose} onLogin={() => {setLogged(true); onClose();}} />}
      <div className="absolute inset-0 -z-10 overflow-hidden">
        <div className="mx-auto h-64 w-[90%] rounded-[2.5rem] bg-gradient-to-r from-rose-500/25 via-amber-400/20 to-emerald-400/20 blur-3xl" />
      </div>

      <motion.div
        initial={{ opacity: 0, y: 12 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5 }}
        className="grid grid-cols-1 lg:grid-cols-2 gap-6 items-center"
      >
        <div>
          <h1 className="text-3xl md:text-5xl font-bold tracking-tight">
            Seu pa√≠s. Suas estrat√©gias. <span className="text-amber-400">Um mundo din√¢mico.</span>
          </h1>
          <p className="mt-3 text-slate-300 max-w-prose">
            Portal integrado para o RPG de pa√≠ses. Acompanhe status do seu pa√≠s, hist√≥rico por turno,
            tratados e pain√©is p√∫blicos. A narra√ß√£o e as imagens continuam no Facebook ‚Äî aqui voc√™
            controla seus n√∫meros.
          </p>
          <div className="mt-5 flex flex-wrap gap-3">
            <button
              onClick={() => (logged ? alert("Abrir painel do jogador") : onLogin())}
              className="inline-flex items-center gap-2 rounded-2xl bg-amber-400 text-slate-900 hover:bg-amber-300 px-4 py-2.5 font-semibold shadow"
            >
              {logged ? <Flag className="h-4 w-4" /> : <LogIn className="h-4 w-4" />} {logged ? "Painel do meu pa√≠s" : "Entrar e acessar"}
            </button>
            <a
              href="#turnos"
              className="inline-flex items-center gap-2 rounded-2xl bg-white/10 hover:bg-white/15 px-4 py-2.5 font-semibold ring-1 ring-white/10"
            >
              <History className="h-4 w-4" /> Ver turnos (Facebook) <ChevronRight className="h-4 w-4" />
            </a>
          </div>
        </div>

        <div className="grid grid-cols-3 gap-3">
          <StatCard icon={<Globe2 className="h-5 w-5" />} label="Era" value={sampleEra} subtle="Hist√≥rico" />
          <StatCard icon={<History className="h-5 w-5" />} label="Turno aberto" value={`#${sampleTurn}`} subtle="1/semana" />
          <StatCard icon={<Users className="h-5 w-5" />} label="Players" value="16" subtle="ativos" />
          <StatCard icon={<TrendingUp className="h-5 w-5" />} label="PIB m√©dio" value="+1,7%" subtle="no √∫ltimo turno" />
          <StatCard icon={<Shield className="h-5 w-5" />} label="Estabilidade" value="78/100" subtle="m√©dia" />
          <StatCard icon={<Map className="h-5 w-5" />} label="Pa√≠ses" value={`${samplePublicCountries.length}`} subtle="p√∫blicos" />
        </div>
      </motion.div>
    </header>
  );
}

function PlayerAndNarratorPanel({ logged, isAdmin, userCountry }) {
  return (
    <section className="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <motion.div
        initial={{ opacity: 0, y: 12 }}
        whileInView={{ opacity: 1, y: 0 }}
        viewport={{ once: true }}
        transition={{ duration: 0.4 }}
        className="lg:col-span-2 rounded-3xl border border-white/10 bg-gradient-to-b from-white/5 to-white/0 p-5"
      >
        <div className="flex items-center justify-between">
          <h2 className="text-lg font-semibold">Pr√©via do Painel do Jogador</h2>
          {logged && (
            <span className="text-xs text-emerald-300/90">Conectado como: {userCountry.name}</span>
          )}
        </div>
        <div className="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
          <MiniMetric title="PIB" value={`$ ${fmt(83826)}`} trend="+2,1%" />
          <MiniMetric title="Estabilidade" value="72/100" trend="-1" />
          <MiniMetric title="Combust√≠vel" value="14.200" trend="+300" />
        </div>
        <div className="mt-5 grid grid-cols-1 md:grid-cols-2 gap-4">
          <div className="rounded-2xl border border-white/10 p-4">
            <h3 className="font-medium">Hist√≥rico recente</h3>
            <ul className="mt-3 space-y-2 text-sm text-slate-300">
              <li>Turno 12: +2,1% PIB, -1 Estab. ‚Äî <a className="underline/30 hover:underline" href="#">ver post</a></li>
              <li>Turno 11: +1,3% PIB ‚Äî <a className="underline/30 hover:underline" href="#">ver post</a></li>
              <li>Turno 10: +0,5% PIB ‚Äî <a className="underline/30 hover:underline" href="#">ver post</a></li>
            </ul>
          </div>
          <div className="rounded-2xl border border-white/10 p-4">
            <h3 className="font-medium">A√ß√µes do pa√≠s</h3>
            <div className="mt-3 grid grid-cols-2 gap-2 text-sm">
              <button className="rounded-xl bg-white/10 hover:bg-white/15 py-2 font-semibold">Produ√ß√£o</button>
              <button className="rounded-xl bg-white/10 hover:bg-white/15 py-2 font-semibold">Mercado</button>
              <button className="rounded-xl bg-white/10 hover:bg-white/15 py-2 font-semibold">Tratados</button>
              <button className="rounded-xl bg-white/10 hover:bg-white/15 py-2 font-semibold">Design (equip.)</button>
            </div>
          </div>
        </div>
      </motion.div>

      {logged && isAdmin && (
        <motion.aside
          initial={{ opacity: 0, y: 12 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ duration: 0.45 }}
          id="narrador"
          className="rounded-3xl border border-white/10 bg-white/5 p-5"
        >
          <div className="flex items-center gap-2">
            <Settings className="h-5 w-5" />
            <h2 className="text-lg font-semibold">Ferramentas do Narrador</h2>
          </div>
          <p className="mt-2 text-sm text-slate-300">
            Acessar o painel completo de gerenciamento para editar pa√≠ses e dados.
          </p>
          <div className="mt-4 grid grid-cols-1 gap-2 text-sm">
            <button onClick={() => alert("Abrir painel de edi√ß√£o completo")} className="rounded-xl bg-amber-400/90 hover:bg-amber-400 text-slate-900 font-semibold py-2">Abrir painel de edi√ß√£o</button>
            <button onClick={() => alert("Gerenciar contas de jogadores")} className="rounded-xl bg-white/10 hover:bg-white/15 py-2 font-semibold">Gerenciar contas de jogadores</button>
          </div>
        </motion.aside>
      )}
    </section>
  );
}

function PublicCountriesPanel({ countries }) {
  return (
    <section id="paises" className="py-8">
      <div className="flex items-center gap-2 mb-4">
        <Globe2 className="h-5 w-5" />
        <h2 className="text-lg font-semibold">Pa√≠ses (p√∫blico)</h2>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        {countries.map((c) => (
          <motion.div
            key={c.id}
            initial={{ opacity: 0, y: 10 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            transition={{ duration: 0.35 }}
            className="rounded-2xl border border-white/10 bg-white/5 p-4 hover:bg-white/10"
          >
            <div className="flex items-center justify-between">
              <div className="text-2xl" title={c.name}>{c.flag}</div>
              <span className="text-xs text-white/60">{c.id}</span>
            </div>
            <h3 className="mt-2 font-semibold tracking-tight">{c.name}</h3>
            <dl className="mt-2 grid grid-cols-2 gap-2 text-sm">
              <div>
                <dt className="text-slate-400">PIB</dt>
                <dd className="font-medium">${" "}{c.pib.toLocaleString("pt-BR")} bi</dd>
              </div>
              <div>
                <dt className="text-slate-400">Estabilidade</dt>
                <dd className="font-medium">{c.estabilidade}/100</dd>
              </div>
            </dl>
            <button
              onClick={() => alert(`Abrir perfil p√∫blico de ${c.name}`)}
              className="mt-3 inline-flex items-center gap-2 text-amber-300 hover:text-amber-200"
            >
              Ver perfil <ChevronRight className="h-4 w-4" />
            </button>
          </motion.div>
        ))}
      </div>
    </section>
  );
}

function TurnFeedPanel({ posts }) {
  return (
    <section id="turnos" className="pb-10">
      <div className="flex items-center gap-2 mb-4">
        <History className="h-5 w-5" />
        <h2 className="text-lg font-semibold">Turnos ‚Äî Relat√≥rios p√∫blicos (Facebook)</h2>
      </div>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        {posts.map((t, idx) => (
          <motion.article
            key={idx}
            initial={{ opacity: 0, y: 10 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            transition={{ duration: 0.35 }}
            className="rounded-2xl border border-white/10 bg-white/5 p-4"
          >
            <h3 className="font-semibold tracking-tight">{t.title}</h3>
            <p className="mt-1 text-sm text-slate-300">{t.summary}</p>
            <a
              href={t.url}
              className="mt-3 inline-flex items-center gap-2 rounded-xl bg-white/10 hover:bg-white/15 px-3 py-2 text-sm font-semibold"
            >
              Abrir no Facebook <ChevronRight className="h-4 w-4" />
            </a>
          </motion.article>
        ))}
      </div>
    </section>
  );
}

function Footer() {
  return (
    <footer className="border-t border-white/10">
      <div className="mx-auto max-w-7xl px-4 py-6 text-sm text-slate-400 flex flex-col sm:flex-row items-center justify-between gap-2">
        <p>¬© {new Date().getFullYear()} WAR RPG ‚Äî Era {sampleEra}</p>
        <div className="flex items-center gap-4">
          <a className="hover:text-slate-200" href="#regras">Regras</a>
          <a className="hover:text-slate-200" href="#">Pol√≠tica</a>
          <a className="hover:text-slate-200" href="#">Contato</a>
        </div>
      </div>
    </footer>
  );
}

function StatCard({ icon, label, value, subtle }) {
  return (
    <div className="rounded-2xl border border-white/10 bg-white/5 p-4">
      <div className="flex items-center justify-between">
        <div className="text-slate-300 text-xs">{label}</div>
        <div className="text-slate-200">{icon}</div>
      </div>
      <div className="mt-1 text-2xl font-bold tracking-tight">{value}</div>
      <div className="text-xs text-slate-400">{subtle}</div>
    </div>
  );
}

function MiniMetric({ title, value, trend }) {
  const negative = typeof trend === "string" && trend.trim().startsWith("-");
  return (
    <div className="rounded-2xl border border-white/10 bg-white/5 p-4">
      <div className="text-xs text-slate-400">{title}</div>
      <div className="mt-1 text-xl font-semibold">{value}</div>
      <div className={`text-xs ${negative ? "text-rose-300" : "text-emerald-300"}`}>{trend}</div>
    </div>
  );
}
